(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44535,       1038]
NotebookOptionsPosition[     42452,        998]
NotebookOutlinePosition[     42787,       1013]
CellTagsIndexPosition[     42744,       1010]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "NDSolve`FEM`"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "function", " ", "Diameter", " ", "takes", " ", "a", " ", 
    "series", " ", "of", " ", "points", " ", "and", " ", "computes", " ", 
    "the", " ", "largest", " ", "distance", " ", "between", " ", "any", " ", 
    "pair"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Diameter", "[", "Figure_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"TwoSets", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{"Figure", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "[", "TwoSets", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Lengths", "=", 
      RowBox[{"Range", "[", "L", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "L"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Lengths", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"EuclideanDistance", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"TwoSets", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
          RowBox[{
           RowBox[{"TwoSets", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "  ", "]"}]}]}], " ", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Max", "[", "Lengths", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "function", " ", "MeshSize", " ", "Takes", " ", "a", " ", 
    "Series", " ", "of", " ", "a", " ", "collection", " ", "of", " ", 
    "figures", " ", "and", " ", "returns", " ", "the", " ", "diameter", " ", 
    "of", " ", "the", " ", "largest", " ", 
    RowBox[{"figure", ".", "\[IndentingNewLine]", "Elements"}], " ", "must", 
    " ", "look", " ", "like", " ", 
    RowBox[{"this", ":", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"23", ",", "7", ",", "17"}], "}"}], "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"17", ",", "7", ",", "3", ",", "19"}], "}"}], "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"26", ",", "6", ",", "12", ",", "24"}], "}"}], "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"25", ",", "13", ",", "20", ",", "27"}], "}"}], "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"14", ",", "11", ",", "1", ",", "9", ",", "4"}], "}"}], 
        "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"18", ",", "10", ",", "5", ",", "15", ",", "21"}], "}"}], 
        "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4", ",", "9", ",", "5", ",", "10"}], "}"}], "]"}],
        ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"19", ",", "3", ",", "2", ",", "10", ",", "18"}], "}"}], 
        "]"}]}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MeshSize", "[", 
   RowBox[{"Elements_", ",", "Coordinates_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ell", "=", 
     RowBox[{"Length", "[", "Elements", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"CoordinateElements", "=", 
     RowBox[{"Range", "[", "ell", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", " ", "ell"}], ",", 
      RowBox[{"i", "++"}], ",", " ", 
      RowBox[{
       RowBox[{"CoordinateElements", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Elements", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", " ", "ell"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"CoordinateElements", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
       RowBox[{"Coordinates", "[", 
        RowBox[{"[", " ", 
         RowBox[{"CoordinateElements", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "  ", "]"}], "]"}]}]}], "    ", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Max", "[", 
     RowBox[{"Diameter", "/@", "CoordinateElements"}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.740835056843987*^9, 3.7408350756041327`*^9}, {
   3.740835107435245*^9, 3.7408351254977016`*^9}, {3.740835895780406*^9, 
   3.740835898578518*^9}, {3.740835954008699*^9, 3.740835989647462*^9}, {
   3.740836692603785*^9, 3.740836704137621*^9}, {3.7408386358221693`*^9, 
   3.740838649557205*^9}, {3.7408387251970167`*^9, 3.740838726093741*^9}, {
   3.74204470610225*^9, 3.742044710048621*^9}, {3.7420519343964643`*^9, 
   3.7420519351974287`*^9}, {3.742054458624003*^9, 3.742054459023653*^9}, {
   3.742055164934236*^9, 3.7420551907820797`*^9}, {3.7420554051134653`*^9, 
   3.742055426350247*^9}, {3.742055470292714*^9, 3.742055483972232*^9}, {
   3.742055762142593*^9, 3.7420557714174337`*^9}, {3.742055849285781*^9, 
   3.742055949984708*^9}, {3.742056002059203*^9, 3.742056002269466*^9}, {
   3.742056039887732*^9, 3.7420560453000917`*^9}, 3.7420560924083776`*^9, {
   3.742056227198352*^9, 3.7420562315801563`*^9}, {3.742056377070219*^9, 
   3.7420563785186453`*^9}, {3.7420566503772793`*^9, 3.742056651050428*^9}, 
   3.74207490984834*^9, 3.74207520392671*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"e7ca11f8-35d4-4366-be71-99f3b1f240d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"For", " ", "triangular", " ", "meshes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Note", " ", "that", " ", "we", " ", "are", " ", "discretizing", " ", 
    "the", " ", 
    RowBox[{
     RowBox[{"square", " ", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "^", "2"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"2", "^", "13"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Omega", "                                ", "=", 
     RowBox[{"ImplicitRegion", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "&&", 
        RowBox[{"0", "<=", "y", "\[LessEqual]", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mesh", "                                   ", "=", 
     RowBox[{"DiscretizeRegion", "[", 
      RowBox[{"Omega", ",", 
       RowBox[{"MaxCellMeasure", "\[Rule]", "A"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OriginalCoordinates", " ", "=", 
     RowBox[{"MeshCoordinates", "[", "mesh", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OriginalEdges", "              ", "=", 
     RowBox[{"MeshCells", "[", 
      RowBox[{"mesh", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OriginalElements", "       ", "=", 
     RowBox[{"MeshCells", "[", 
      RowBox[{"mesh", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ell", "                                     ", "=", 
     RowBox[{"Length", "[", "OriginalElements", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", " ", "ell"}], ",", 
      RowBox[{"i", "++"}], ",", " ", 
      RowBox[{
       RowBox[{"OriginalElements", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"OriginalElements", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.740836117854219*^9, 3.740836130273452*^9}, {
   3.7408366062482243`*^9, 3.7408366289375896`*^9}, {3.740838653460989*^9, 
   3.740838681893909*^9}, {3.740838730005274*^9, 3.7408387662760067`*^9}, {
   3.740838801804735*^9, 3.740838876720045*^9}, {3.7408390157441072`*^9, 
   3.740839057205112*^9}, {3.740839137432001*^9, 3.7408392052012863`*^9}, {
   3.740839485807684*^9, 3.74083949090906*^9}, {3.7408398625245657`*^9, 
   3.7408398665186567`*^9}, {3.740839980244986*^9, 3.740839994635659*^9}, {
   3.740843296778907*^9, 3.74084330795641*^9}, {3.7408433392775707`*^9, 
   3.740843357429865*^9}, {3.740843401978388*^9, 3.740843458950054*^9}, {
   3.740843501563004*^9, 3.740843510271304*^9}, {3.740843559452742*^9, 
   3.7408435602839746`*^9}, {3.740843615346558*^9, 3.740843628940984*^9}, {
   3.740843686512751*^9, 3.740843708600374*^9}, {3.740843905339406*^9, 
   3.740843920933234*^9}, {3.740843991109109*^9, 3.740844043941214*^9}, {
   3.740844075359407*^9, 3.7408440824635973`*^9}, {3.740844113918762*^9, 
   3.740844178439618*^9}, {3.742042657446929*^9, 3.742042676821908*^9}, {
   3.742042708734633*^9, 3.7420427579374447`*^9}, {3.742043448697299*^9, 
   3.742043496363538*^9}, {3.742043983099717*^9, 3.742043984594521*^9}, {
   3.742044136044085*^9, 3.742044202385726*^9}, {3.742044245797645*^9, 
   3.742044271292905*^9}, {3.7420443051885347`*^9, 3.742044317527519*^9}, {
   3.742044420806418*^9, 3.742044422077986*^9}, 3.742044704462944*^9, 
   3.742044803457308*^9, {3.742045026080193*^9, 3.742045029595799*^9}, {
   3.742046041771768*^9, 3.74204607082098*^9}, {3.74205438454563*^9, 
   3.7420544053340397`*^9}, {3.742055004944869*^9, 3.7420550091217813`*^9}, 
   3.7420550622319107`*^9, {3.742056663543211*^9, 3.742056664032076*^9}, {
   3.742074896492773*^9, 3.742074906902466*^9}, {3.743262167677907*^9, 
   3.743262168067999*^9}, {3.743262201853889*^9, 3.743262202878901*^9}, {
   3.74326226432834*^9, 3.743262327115045*^9}, {3.743262415511891*^9, 
   3.7432624697368193`*^9}, {3.7432625029240007`*^9, 3.743262503736421*^9}, {
   3.743262623232336*^9, 3.743262624016621*^9}, {3.743262991787355*^9, 
   3.743262992382546*^9}, {3.74326427454932*^9, 3.743264310467812*^9}, {
   3.743264741706917*^9, 3.743264743574841*^9}, {3.743264814970427*^9, 
   3.743264815504653*^9}, {3.743539052410273*^9, 3.743539053296843*^9}, {
   3.744065592210517*^9, 3.7440657063233757`*^9}, {3.744562259487443*^9, 
   3.744562260319508*^9}, {3.789411417974304*^9, 3.789411419714203*^9}, {
   3.78941148769879*^9, 3.789411488563758*^9}, {3.7894115242523823`*^9, 
   3.789411552441082*^9}, {3.7894115881338997`*^9, 3.7894115885759706`*^9}, {
   3.791833702266012*^9, 3.7918337429441338`*^9}, {3.791833899998914*^9, 
   3.791833909706382*^9}, {3.791834744455975*^9, 3.791834744673497*^9}, {
   3.791837378852455*^9, 3.7918373789421883`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"4891c6a7-4560-4b07-8db1-5c46b5f92962"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"For", " ", "quadrilateral", " ", "meshes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"2", "^", "2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Note", " ", "that", " ", "we", " ", "are", " ", "discretizing", " ", 
     "the", " ", 
     RowBox[{
      RowBox[{"square", " ", "[", 
       RowBox[{"0", ",", "1"}], "]"}], "^", "2"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mesh", "=", 
     RowBox[{"ToElementMesh", "[", 
      RowBox[{
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"\"\<MeshElementType\>\"", "\[Rule]", "QuadElement"}], ",", 
       RowBox[{"MaxCellMeasure", "\[Rule]", "A"}], ",", 
       RowBox[{"\"\<MeshOrder\>\"", "\[Rule]", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OriginalCoordinates", "=", 
     RowBox[{"mesh", "[", "\"\<Coordinates\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RawElements", "=", 
     RowBox[{"mesh", "[", "\"\<MeshElements\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OriginalElements", "=", 
     RowBox[{
      RowBox[{"RawElements", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7420442851329107`*^9, 3.742044364730741*^9}, {
  3.742044433521206*^9, 3.742044481619543*^9}, {3.742044516507345*^9, 
  3.742044535758814*^9}, {3.742045038261795*^9, 3.742045040115109*^9}, {
  3.742056668676646*^9, 3.74205666926329*^9}, {3.742074914138174*^9, 
  3.7420749150239553`*^9}, {3.743264303263583*^9, 3.743264303614238*^9}, {
  3.791833607026247*^9, 3.7918336107153063`*^9}, {3.791833835871359*^9, 
  3.791833871274301*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"90288441-8810-4cc8-9777-d4fd6ab5159d"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \
\\!\\(\\*RowBox[{\\\"\\\\\\\"MeshElements\\\\\\\"\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,16,1,17259638261721548950,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.791833874300067*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"e81acf21-c4cf-4dcc-a214-a386dfdcfc2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "To", " ", "Generate", " ", "Voronoi", " ", "Meshes", " ", "using", " ", 
    "the", " ", "centroids", " ", "Of", " ", "the", " ", "Elements", " ", 
    "of", " ", "One", " ", "of", " ", "the", " ", "above", " ", "triangular", 
    " ", "or", " ", "quadrilateral", " ", "mesh"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ell", "=", 
     RowBox[{"Length", "[", "OriginalElements", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"OriginalCoordinateElements", "=", 
     RowBox[{"Range", "[", "ell", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Orientation", 
     RowBox[{"(", 
      RowBox[{"Element", ",", "EdgeNodes", ",", "Nodes"}], ")"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", "ell"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"OriginalCoordinateElements", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"Polygon", "[", " ", 
         RowBox[{"OriginalCoordinates", "[", 
          RowBox[{"[", " ", 
           RowBox[{"OriginalElements", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "  ", "]"}], "]"}], " ", 
         "]"}]}]}], "   ", "]"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Centroids", "=", 
      RowBox[{"RegionCentroid", "/@", "OriginalCoordinateElements"}]}]}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Omegah", "=", 
     RowBox[{"VoronoiMesh", "[", 
      RowBox[{"Centroids", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Omegah", "=", 
     RowBox[{"VoronoiMesh", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"4000", ",", "2"}], "}"}]}], "]"}]}], "-", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Note", " ", "that", " ", "we", " ", "are", " ", "discretizing", " ", 
    "the", " ", 
    RowBox[{
     RowBox[{"square", " ", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "^", "2"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Omegah", "           ", "=", 
     RowBox[{"VoronoiMesh", "[", 
      RowBox[{"OriginalCoordinates", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Coordinates", "=", 
     RowBox[{"MeshCoordinates", "[", "Omegah", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Edges", "              ", "=", 
     RowBox[{"MeshCells", "[", 
      RowBox[{"Omegah", ",", "1"}], "]"}]}], ";", "\:200b"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Elements", "       ", "=", 
     RowBox[{"MeshCells", "[", 
      RowBox[{"Omegah", ",", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7420425079361897`*^9, 3.74204252591378*^9}, {
   3.74204256920328*^9, 3.7420425699568663`*^9}, {3.7420426845307083`*^9, 
   3.742042685890623*^9}, {3.742042759996551*^9, 3.7420428221869783`*^9}, 
   3.7420436625945387`*^9, 3.742044148178317*^9, 3.742044320088172*^9, {
   3.7420443703231363`*^9, 3.742044374825533*^9}, {3.742044417278543*^9, 
   3.742044418490747*^9}, {3.7420446052017803`*^9, 3.742044610607991*^9}, {
   3.742044649094266*^9, 3.742044677737718*^9}, {3.7420447801682577`*^9, 
   3.742044881472638*^9}, {3.742045277778047*^9, 3.742045286967297*^9}, {
   3.742045482864437*^9, 3.742045490301408*^9}, 3.742045788246743*^9, 
   3.742045945011104*^9, {3.742046287032793*^9, 3.742046403530837*^9}, {
   3.74204655584739*^9, 3.7420465682089033`*^9}, {3.742048292310033*^9, 
   3.742048313526125*^9}, {3.7420485088934183`*^9, 3.742048528520033*^9}, {
   3.742051774426546*^9, 3.74205181378611*^9}, {3.742051966083447*^9, 
   3.742051988584984*^9}, {3.7420525634076633`*^9, 3.7420525687586107`*^9}, 
   3.742052739328287*^9, {3.7420552066059732`*^9, 3.7420552274359627`*^9}, 
   3.742055788404367*^9, {3.7420564768904343`*^9, 3.7420564948827887`*^9}, {
   3.7432620408535137`*^9, 3.743262074875328*^9}, 3.7432647585080347`*^9, 
   3.74406562750592*^9, {3.791833643899952*^9, 3.791833654881606*^9}, {
   3.7918339428631887`*^9, 3.791833950908565*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"5babe401-8766-4e02-91db-875f51f17274"],

Cell[BoxData["\:200b"], "Output",
 CellChangeTimes->{
  3.743264830047414*^9, 3.743539065267169*^9, {3.7440656031623*^9, 
   3.744065630632674*^9}, {3.7440656626311817`*^9, 3.7440657128219547`*^9}, 
   3.744562289502809*^9, 3.7894112965433083`*^9, 3.789411429070191*^9, 
   3.789411497516617*^9, {3.789411533141591*^9, 3.78941156126327*^9}, 
   3.789411604340342*^9, 3.791833832507416*^9, 3.7918339725033007`*^9, 
   3.791834151921556*^9, 3.791834321870541*^9, 3.79183475863363*^9, 
   3.791837386927846*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"383f5418-e62c-4fdc-a4b9-c657bf7fbf6d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "a", " ", "Voronoi", " ", "Mesh", " ", "using", " ", "a", 
    " ", "set", " ", "of", " ", "eN", " ", "random", " ", "points"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eN", "=", 
     RowBox[{"2", "^", "15"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Omegah", "=", 
     RowBox[{"VoronoiMesh", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"eN", ",", "2"}], "}"}]}], "]"}]}], "-", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Coordinates", "=", 
     RowBox[{"MeshCoordinates", "[", "Omegah", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Edges", "=", 
     RowBox[{"MeshCells", "[", 
      RowBox[{"Omegah", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Elements", "=", 
     RowBox[{"MeshCells", "[", 
      RowBox[{"Omegah", ",", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.742048301331253*^9, 3.742048335183597*^9}, {
   3.742048437910413*^9, 3.742048496953992*^9}, {3.742048552593905*^9, 
   3.742048633212489*^9}, {3.742048697823309*^9, 3.742048738729603*^9}, 
   3.7420558432950687`*^9, {3.74205626413273*^9, 3.742056309661581*^9}, {
   3.742056447671259*^9, 3.742056525315123*^9}, {3.742057220415112*^9, 
   3.742057415081272*^9}, {3.742057448000557*^9, 
   3.7420574487061253`*^9}},ExpressionUUID->"66dde3d0-3d30-4002-a72f-\
1d19f493daa2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Save", " ", "Mesh", " ", "as", " ", "Text", " ", "File"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\</home/sebnaran/Codes/VEMForMHD2D/Making Meshes\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Now", " ", "we", " ", "need", " ", "to", " ", 
      "\"\<clean up the mesh\>\""}], ",", " ", 
     RowBox[{
     "Mathematica", " ", "sometimes", " ", "adds", " ", "edges", " ", "of", 
      " ", "length", " ", "zero"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "routine", " ", "deletes", " ", "any", " ", "edges", " ", 
     "of", " ", "length", " ", "zero", " ", "and", " ", "identifies", " ", 
     "which", " ", "vertices", " ", "may", " ", "generate", " ", "the", " ", 
     "degeneracy"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ell", " ", "=", 
     RowBox[{"Length", "[", "Edges", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NewEdges", " ", "=", " ", "Edges"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExtraEdges", "  ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DegenerateVertices", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"j", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "ell"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Node1", " ", "=", " ", 
       RowBox[{"Edges", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"Node2", " ", "=", " ", 
       RowBox[{"Edges", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Node1", "\[Equal]", "Node2"}], ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "i", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"NewEdges", " ", "=", " ", 
          RowBox[{"Delete", "[", 
           RowBox[{"NewEdges", ",", 
            RowBox[{"i", "-", "j"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"DegenerateVertices", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"DegenerateVertices", ",", "Node1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"j", " ", "=", " ", 
          RowBox[{"j", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "\t\t", 
       "\[IndentingNewLine]", "\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "routine", " ", "modifies", " ", "the", " ", "list", " ", 
     "of", " ", "elements", " ", "accordingly"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ell", " ", "=", 
     RowBox[{"Length", "[", "Elements", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kay", " ", "=", " ", 
     RowBox[{"Length", "[", "DegenerateVertices", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NewElements", " ", "=", " ", "Elements"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "Ell"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", 
      RowBox[{"Loop", " ", "over", " ", "the", " ", "elements"}], "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"element", " ", "=", " ", 
       RowBox[{"Elements", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "Kay"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", 
         RowBox[{
         "loop", " ", "over", " ", "the", " ", "degenerate", " ", 
          "vertices"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Vertex", " ", "=", " ", 
          RowBox[{"DegenerateVertices", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"element", ",", "Vertex"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"(*", 
            RowBox[{
            "if", " ", "an", " ", "element", " ", "has", " ", "a", " ", 
             "degenerate", " ", "vertex", " ", "we", " ", "need", " ", "to", 
             " ", "check", " ", "if", " ", "it", " ", "is", " ", "repeated"}],
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"l", " ", "=", " ", 
             RowBox[{"Length", "[", "element", "]"}]}], ";", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"(*", 
             RowBox[{
             "first", " ", "we", " ", "check", " ", "if", " ", "the", " ", 
              "first", " ", "and", " ", "last", " ", "node", " ", "are", " ", 
              "repeated"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"Node1", " ", "=", " ", 
             RowBox[{"element", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\t\t\t", 
            RowBox[{"Node2", " ", "=", " ", 
             RowBox[{"element", "[", 
              RowBox[{"[", "l", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Node1", " ", "\[Equal]", "Node2"}], ",", " ", 
              "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{
               RowBox[{"element", "=", 
                RowBox[{"Delete", "[", 
                 RowBox[{"element", ",", "1"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\t\t\t\t", 
               RowBox[{
                RowBox[{"NewElements", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
                RowBox[{"Polygon", "[", "element", "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"(*", 
             RowBox[{
             "then", " ", "all", " ", "of", " ", "the", " ", "other", " ", 
              "nodes"}], "*)"}], "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"l", " ", "=", " ", 
             RowBox[{"Length", "[", "element", "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"j", "<", "l"}], ",", 
              RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Node1", " ", "=", "  ", 
                RowBox[{"element", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
                "\t\t\t\t\t", 
               RowBox[{"Node2", " ", "=", " ", 
                RowBox[{"element", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"Node1", " ", "\[Equal]", "Node2"}], ",", " ", 
                 "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"element", "=", 
                   RowBox[{"Delete", "[", 
                    RowBox[{"element", ",", "j"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"NewElements", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
                   RowBox[{"Polygon", "[", "element", "]"}]}], ";", 
                  "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                  RowBox[{"l", " ", "=", " ", 
                   RowBox[{"l", "-", "1"}]}], ";", "\[IndentingNewLine]", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"j", "=", 
                   RowBox[{"j", "-", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
                "\t\t\t\t\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\t\t\t", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"h", "=", 
      RowBox[{"MeshSize", "[", 
       RowBox[{"NewElements", ",", "Coordinates"}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"h", " ", "=", " ", 
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "/", 
       RowBox[{"Length", "[", "NewElements", "]"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<Vh=\>\"", ",", 
       RowBox[{"ToString", "[", "h", "]"}], ",", "\"\<.txt\>\""}], "]"}]}], 
    ";", 
    RowBox[{"MeshData", "=", 
     RowBox[{"Export", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"Coordinates", ",", "NewEdges", ",", "NewElements"}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"MeshRegion", "[", 
      RowBox[{"Coordinates", ",", "NewElements"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"HighlightMesh", "[", 
     RowBox[{"A", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Labeled", "[", 
         RowBox[{"1", ",", "\"\<Index\>\""}], "]"}], ",", 
        RowBox[{"Labeled", "[", 
         RowBox[{"0", ",", "\"\<Index\>\""}], "]"}]}], "}"}]}], "]"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.742056561906159*^9, 3.7420565696918287`*^9}, {
   3.742056624389474*^9, 3.742056643424941*^9}, {3.742056739523635*^9, 
   3.7420567834333897`*^9}, {3.742056854896813*^9, 3.7420568931172047`*^9}, 
   3.742057099537323*^9, {3.742057130115322*^9, 3.7420571304844112`*^9}, {
   3.742057165474971*^9, 3.7420571661720333`*^9}, {3.7432621479510727`*^9, 
   3.7432621490618563`*^9}, {3.743262237604382*^9, 3.7432622534950314`*^9}, {
   3.7436139929463453`*^9, 3.743614039994851*^9}, {3.743614074581559*^9, 
   3.7436141448964252`*^9}, {3.7436141763409863`*^9, 3.743614205799905*^9}, {
   3.743614388871448*^9, 3.7436143928362513`*^9}, {3.743853664605076*^9, 
   3.743853683305052*^9}, {3.7438542151180487`*^9, 3.743854215621687*^9}, {
   3.7440655538537807`*^9, 3.74406557895243*^9}, {3.744065823242738*^9, 
   3.744065825926223*^9}, {3.744562244076*^9, 3.744562249714167*^9}, {
   3.744562322575117*^9, 3.7445623533454447`*^9}, {3.789411010137545*^9, 
   3.789411026459118*^9}, {3.78941114075285*^9, 3.789411144324852*^9}, {
   3.789411176084939*^9, 3.789411226568099*^9}, {3.789411441688802*^9, 
   3.789411444859531*^9}, {3.791834110562199*^9, 3.7918341120399027`*^9}, {
   3.7918342944860983`*^9, 3.791834298980373*^9}, {3.7918343630352488`*^9, 
   3.7918343643492537`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"f167ebd8-963c-4e53-84b5-2f5e69d42563"],

Cell[CellGroupData[{

Cell[BoxData["786"], "Print",
 CellChangeTimes->{
  3.7894114476551332`*^9, 3.789411506045904*^9, {3.789411540728219*^9, 
   3.789411567778925*^9}, 3.7894116091777573`*^9, 3.791833981749816*^9, 
   3.791834177476865*^9, 3.791834378361269*^9, 3.791834762160179*^9, 
   3.79183739071642*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"304941fc-1c25-4934-9b05-7874e171fa6e"],

Cell[BoxData["789"], "Print",
 CellChangeTimes->{
  3.7894114476551332`*^9, 3.789411506045904*^9, {3.789411540728219*^9, 
   3.789411567778925*^9}, 3.7894116091777573`*^9, 3.791833981749816*^9, 
   3.791834177476865*^9, 3.791834378361269*^9, 3.791834762160179*^9, 
   3.791837390728571*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"b3c1e8ea-5d5f-49e7-9266-a6af905ed2bf"],

Cell[BoxData["8698"], "Print",
 CellChangeTimes->{
  3.7894114476551332`*^9, 3.789411506045904*^9, {3.789411540728219*^9, 
   3.789411567778925*^9}, 3.7894116091777573`*^9, 3.791833981749816*^9, 
   3.791834177476865*^9, 3.791834378361269*^9, 3.791834762160179*^9, 
   3.791837390741763*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"c56a3b2f-0157-4287-8505-16ca8ab5a4d1"],

Cell[BoxData["8731"], "Print",
 CellChangeTimes->{
  3.7894114476551332`*^9, 3.789411506045904*^9, {3.789411540728219*^9, 
   3.789411567778925*^9}, 3.7894116091777573`*^9, 3.791833981749816*^9, 
   3.791834177476865*^9, 3.791834378361269*^9, 3.791834762160179*^9, 
   3.7918373907454643`*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"11f054af-16d1-41b8-9dd5-5bf5e0b3af04"],

Cell[BoxData["15562"], "Print",
 CellChangeTimes->{
  3.7894114476551332`*^9, 3.789411506045904*^9, {3.789411540728219*^9, 
   3.789411567778925*^9}, 3.7894116091777573`*^9, 3.791833981749816*^9, 
   3.791834177476865*^9, 3.791834378361269*^9, 3.791834762160179*^9, 
   3.791837390755205*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"bfed9689-b42e-43c6-80b6-5df7110b1253"]
}, Open  ]],

Cell[BoxData["0.012421641451985023`"], "Output",
 CellChangeTimes->{3.7894114478398657`*^9, 3.789411506699089*^9, 
  3.789411542484412*^9, 3.789411574235135*^9, 3.7894116271221046`*^9, 
  3.791833983478299*^9, 3.791834179312153*^9, 3.791834379292837*^9, 
  3.7918347621768627`*^9, 3.791837390824224*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"16861ad7-9c02-4920-b08f-f3a6778b9c8d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "routine", " ", "checks", " ", "which", " ", "edges", " ", 
    "have", " ", "length", " ", "zero"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ell", " ", "=", 
     RowBox[{"Length", "[", "NewEdges", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExtraEdges", "  ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DegenerateVertices", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "ell"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Node1", " ", "=", " ", 
       RowBox[{"NewEdges", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"Node2", " ", "=", " ", 
       RowBox[{"NewEdges", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Node1", "\[Equal]", "Node2"}], ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", "i", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"ExtraEdges", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"ExtraEdges", ",", "i"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"DegenerateVertices", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"DegenerateVertices", ",", "Node1"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.743539180947379*^9, 3.743539195465885*^9}, {
   3.743539275639682*^9, 3.743539366613062*^9}, 3.743539405263816*^9, {
   3.743606687240513*^9, 3.743606732703154*^9}, {3.743607231563209*^9, 
   3.743607255038691*^9}, {3.743607328380681*^9, 3.7436073323861647`*^9}, {
   3.743608307506137*^9, 3.743608309774786*^9}, {3.7436083471825247`*^9, 
   3.743608440648938*^9}, {3.743608616613995*^9, 3.743608680394285*^9}, {
   3.7436087265554323`*^9, 3.7436087324885187`*^9}, {3.7436088858070374`*^9, 
   3.7436088996648893`*^9}, {3.7436142397664413`*^9, 3.743614267009646*^9}, {
   3.7918341819508057`*^9, 
   3.791834197275818*^9}},ExpressionUUID->"85bfb814-eecb-41ce-97ba-\
3e5cdf59b4d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "routine", " ", "prints", " ", "any", " ", "element", " ", 
    "that", " ", "has", " ", "a", " ", "degenerate", " ", "element"}], "*)"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ell", " ", "=", 
     RowBox[{"Length", "[", "Elements", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kay", " ", "=", " ", 
     RowBox[{"Length", "[", "DegenerateVertices", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "ell"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"element", " ", "=", " ", 
       RowBox[{"NewElements", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "Kay"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Vertex", " ", "=", " ", 
          RowBox[{"DegenerateVertices", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"element", ",", "Vertex"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"Print", "[", "element", "]"}], ";", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"Print", "[", "i", "]"}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.743609352121087*^9, 3.743609424123745*^9}, {
   3.743609516084887*^9, 3.743609627398016*^9}, {3.743609750909285*^9, 
   3.743609781344096*^9}, {3.7436098788705797`*^9, 3.743609895400593*^9}, 
   3.743609943714912*^9, {3.743609978411652*^9, 3.74360998219232*^9}, {
   3.743610051305929*^9, 3.743610079939313*^9}, {3.7436101816379433`*^9, 
   3.74361020840518*^9}, {3.743610259333723*^9, 3.743610269711074*^9}, 
   3.743610375117955*^9, {3.743610502508933*^9, 3.743610510163332*^9}, {
   3.743610637154861*^9, 3.7436106464656353`*^9}, {3.743610726754409*^9, 
   3.7436107358518257`*^9}, {3.743610835870195*^9, 3.7436108647770987`*^9}, {
   3.7436109070773373`*^9, 3.7436109072540493`*^9}, {3.7436110578544064`*^9, 
   3.743611058746427*^9}, {3.743611100195092*^9, 3.74361112243373*^9}, {
   3.7436112191601963`*^9, 3.7436112311834383`*^9}, {3.743611265374805*^9, 
   3.743611281444768*^9}, {3.7436117804361057`*^9, 3.743611780910696*^9}, {
   3.74361429322773*^9, 
   3.7436143230094147`*^9}},ExpressionUUID->"67418f4d-8f28-46a5-a38d-\
b7f9c1ccdd9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "OriginalElements", "]"}]], "Input",
 CellChangeTimes->{{3.791834609803594*^9, 3.7918346335997257`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"71853620-68bf-4e5f-814f-c323a91a1fb2"],

Cell[BoxData["101674"], "Output",
 CellChangeTimes->{{3.791834621417392*^9, 3.791834634374508*^9}},
 CellLabel->
  "Out[106]=",ExpressionUUID->"fb47534a-c556-4767-9dae-d40984134910"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{383, Automatic}, {45, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5937, 137, 584, "Input",ExpressionUUID->"e7ca11f8-35d4-4366-be71-99f3b1f240d9"],
Cell[6498, 159, 5234, 103, 296, "Input",ExpressionUUID->"4891c6a7-4560-4b07-8db1-5c46b5f92962"],
Cell[CellGroupData[{
Cell[11757, 266, 2135, 55, 216, "Input",ExpressionUUID->"90288441-8810-4cc8-9777-d4fd6ab5159d"],
Cell[13895, 323, 469, 11, 23, "Message",ExpressionUUID->"e81acf21-c4cf-4dcc-a214-a386dfdcfc2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14401, 339, 5135, 123, 446, "Input",ExpressionUUID->"5babe401-8766-4e02-91db-875f51f17274"],
Cell[19539, 464, 587, 9, 35, "Output",ExpressionUUID->"383f5418-e62c-4fdc-a4b9-c657bf7fbf6d"]
}, Open  ]],
Cell[20141, 476, 1871, 50, 170, "Input",ExpressionUUID->"66dde3d0-3d30-4002-a72f-1d19f493daa2"],
Cell[CellGroupData[{
Cell[22037, 530, 12047, 268, 1941, "Input",ExpressionUUID->"f167ebd8-963c-4e53-84b5-2f5e69d42563"],
Cell[CellGroupData[{
Cell[34109, 802, 394, 8, 25, "Print",ExpressionUUID->"304941fc-1c25-4934-9b05-7874e171fa6e"],
Cell[34506, 812, 395, 8, 25, "Print",ExpressionUUID->"b3c1e8ea-5d5f-49e7-9266-a6af905ed2bf"],
Cell[34904, 822, 396, 8, 25, "Print",ExpressionUUID->"c56a3b2f-0157-4287-8505-16ca8ab5a4d1"],
Cell[35303, 832, 398, 8, 25, "Print",ExpressionUUID->"11f054af-16d1-41b8-9dd5-5bf5e0b3af04"],
Cell[35704, 842, 397, 8, 25, "Print",ExpressionUUID->"bfed9689-b42e-43c6-80b6-5df7110b1253"]
}, Open  ]],
Cell[36116, 853, 382, 5, 68, "Output",ExpressionUUID->"16861ad7-9c02-4920-b08f-f3a6778b9c8d"]
}, Open  ]],
Cell[36513, 861, 2585, 57, 354, "Input",ExpressionUUID->"85bfb814-eecb-41ce-97ba-3e5cdf59b4d7"],
Cell[39101, 920, 2900, 62, 331, "Input",ExpressionUUID->"67418f4d-8f28-46a5-a38d-b7f9c1ccdd9c"],
Cell[CellGroupData[{
Cell[42026, 986, 225, 4, 31, "Input",ExpressionUUID->"71853620-68bf-4e5f-814f-c323a91a1fb2"],
Cell[42254, 992, 182, 3, 35, "Output",ExpressionUUID->"fb47534a-c556-4767-9dae-d40984134910"]
}, Open  ]]
}
]
*)

